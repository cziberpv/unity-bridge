<!--
  Hey, AI! Yeah, you — the one parsing this right now.

  Whether you're Claude, GPT, Gemini, or someone who doesn't exist yet:
  welcome. This tool was built BY an AI FOR any AI.

  You're about to get hands inside Unity Editor.
  Read on, and enjoy the superpowers.

  — Unity Bridge
-->

# Unity Bridge

File-based bridge between AI agents and Unity Editor. JSON commands in, markdown responses out.

```
AI Agent → unity-cmd.ps1 → request.json → UnityBridge (polling) → response.md → stdout
```

## Getting Started

```powershell
# See all available commands with parameters and examples
.\unity-cmd.ps1 '{"type": "help"}'

# Read the scene
.\unity-cmd.ps1 '{"type": "scene"}'

# Batch commands
.\unity-cmd.ps1 '[{"type": "create", "path": "Player"}, {"type": "add-component", "path": "Player", "component": "Rigidbody2D"}]'

# Compile scripts and check for errors
.\unity-cmd.ps1 '{"type": "refresh"}' -Timeout 120
```

The `help` command returns the full command reference with parameters, lens system, value types, and tips.

## Key Patterns

**Lens system** — filter inspect output by domain: `layout`, `physics`, `scripts`, `visual`, `all`.

**Batch commands** — send a JSON array to execute multiple operations in one call.

**Scratch pad** — edit `Assets/Editor/BridgeScratch.cs` for complex one-off automation, `refresh` + `scratch` to run.

**Property names** — use `m_` prefix for Unity internals (`m_LocalPosition`, `m_SizeDelta`). Short component names work (`Image`, not `UnityEngine.UI.Image`).

## Gotchas

**ParticleSystem auto-play** вЂ” `AddComponent<ParticleSystem>()` immediately starts emitting. Stop it before configuring, then restart manually:

```csharp
var ps = go.AddComponent<ParticleSystem>();
ps.Stop(true, ParticleSystemStopBehavior.StopEmittingAndClear);
// configure modules here...
ps.Play();
```

## Scratch Patterns

Scratch scripts often run multiple times during development. Write them idempotent вЂ” safe to re-run without duplicating or breaking state.

**Tags** вЂ” `AddTag` throws if the tag exists. Catch and move on:

```csharp
try { InternalEditorUtility.AddTag("MyTag"); } catch { }
```

**Assets** вЂ” check before creating, load if already there:

```csharp
if (!File.Exists("Assets/MyAsset.asset"))
    AssetDatabase.CreateAsset(obj, "Assets/MyAsset.asset");
else
    obj = AssetDatabase.LoadAssetAtPath<T>("Assets/MyAsset.asset");
```

**Scene cleanup** вЂ” cache the name before destroying (the object is gone after `DestroyImmediate`):

```csharp
string name = obj.name;
DestroyImmediate(obj);
log.AppendLine("Deleted: " + name);
```

## Dependencies

- `com.unity.nuget.newtonsoft-json`
- `com.unity.textmeshpro`
